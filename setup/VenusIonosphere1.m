
function ne = VenusIonosphere1(alt,ind)

% Ionosphere for Venus, taken from three profiles in Venus II, page 181;
% these are from Kliore and Luhmann, JGR, 1991.
%
% A(:,:,1) is most dense (high solar activity) profile 
% A(:,:,2) is intermediate profile
% A(:,:,3) is least dense (low solar activity) profile
%

%       1            2      3
A(:,:,1) = [60.00 -0.10000E+01 -1.000;
    70.00 -0.10000E+01 -1.000;
    80.00 -0.10000E+01 -1.000;
    90.00 -0.10000E+01 -1.000;
    100.00 0.00000E+01 -1.000;
    110.00 1.00000E+09 -1.000;
    120.00 2.00000E+09 -1.000;
    130.00 4.00000E+09 -1.000;
    140.00 8.00000E+09 -1.000;
    145.00 1.50000E+10 -1.000;
    150.00 1.00000E+10 -1.000;
    160.00 5.00000E+09 -1.000;
    170.00 3.00000E+09 -1.000;
    180.00 2.00000E+09 -1.000;
    190.00 1.50000E+09 -1.000;
    200.00 1.20000E+09 -1.000;
    220.00 8.20000E+08 -1.000;
    240.00 6.00000E+08 -1.000;
    260.00 4.20000E+08 -1.000;
    280.00 2.70000E+08 -1.000;
    300.00 1.90000E+08 -1.000;
    350.00 1.00000E+08 -1.000;
    400.00 5.00000E+07 -1.000;
    450.00 2.00000E+07 -1.000;
    500.00 1.00000E+07 -1.000];

A(:,:,2) = [60.00 -0.10000E+01 -1.000;
    70.00 -0.10000E+01 -1.000;
    80.00 -0.10000E+01 -1.000;
    90.00 -0.10000E+01 -1.000;
    100.00 0.00000E+01 -1.000;
    110.00 1.00000E+09 -1.000;
    120.00 2.00000E+09 -1.000;
    130.00 4.00000E+09 -1.000;
    140.00 7.00000E+09 -1.000;
    145.00 9.00000E+09 -1.000;
    150.00 5.00000E+09 -1.000;
    160.00 2.00000E+09 -1.000;
    170.00 1.50000E+09 -1.000;
    180.00 1.20000E+09 -1.000;
    190.00 1.00000E+09 -1.000;
    200.00 8.00000E+08 -1.000;
    220.00 4.50000E+08 -1.000;
    240.00 2.00000E+08 -1.000;
    260.00 1.00000E+08 -1.000;
    280.00 7.00000E+07 -1.000;
    300.00 5.00000E+07 -1.000;
    350.00 2.00000E+07 -1.000;
    400.00 1.00000E+07 -1.000;
    450.00 0.50000E+07 -1.000;
    500.00 0.20000E+07 -1.000];

A(:,:,3) = [60.00 -0.10000E+01 -1.000;
    70.00 -0.10000E+01 -1.000;
    80.00 -0.10000E+01 -1.000;
    90.00 -0.10000E+01 -1.000;
    100.00 0.00000E+01 -1.000;
    110.00 1.00000E+09 -1.000;
    120.00 2.00000E+09 -1.000;
    130.00 4.00000E+09 -1.000;
    140.00 7.00000E+09 -1.000;
    145.00 5.00000E+09 -1.000;
    150.00 2.00000E+09 -1.000;
    160.00 0.50000E+09 -1.000;
    170.00 0.20000E+09 -1.000;
    180.00 1.00000E+08 -1.000;
    190.00 8.00000E+07 -1.000;
    200.00 6.70000E+07 -1.000;
    220.00 5.00000E+07 -1.000;
    240.00 3.00000E+07 -1.000;
    260.00 2.00000E+07 -1.000;
    280.00 1.40000E+07 -1.000;
    300.00 1.00000E+07 -1.000;
    350.00 0.45000E+07 -1.000;
    400.00 0.20000E+07 -1.000;
    450.00 0.10000E+07 -1.000;
    500.00 0.05000E+07 -1.000];

netemp = A(:,2,ind);
netemp(netemp < 0) = 0;
h = A(:,1,ind);

ne = interp1(h,netemp,alt,'cubic');

fi = find(alt > 100,1,'first');
logne = interp1([1 fi],[-5 log10(ne(fi))],1:fi,'linear');
ne(1:fi) = 10.^(logne);
