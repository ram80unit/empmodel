% IRI ionosphere for January 2011, somewhere over US

function ne = IRIionosphere1(alt)

% Required input parameters
% Year= 2011., Month= 01, Day= 01, Hour=1.,
% Time_type = Local
% Coordinate_type = Geographic
% Latitude= 40., Longitude= 260., Height= 100.
% Prof. parameters: Start= 60. Stop= 400. Step= 1.

% Optional input parameters:
% Sunspot number(Rz12) =not specifyed
% Ionospheric index(IG12) =not specifyed
% Upper limit for Electron content = not specifyed
% F peak model = URSI
% Ne Topside = NeQuick
% foF2 Storm model = on
% Bottomside Thickness = B0 Table
% F1 occurrence probability = Scotto-1997 no L
% D-Region Ne = IRI-95
% Topside Te = TTSA-2000
% Ion Composition = DS95/TT05
% A value of -1 indicates that the parameter is not available for the specified range
% TEC=-1, means you have not entered an upper boundary height in the OPTIONAL INPUT section.
%    Selected parameters are:
% 1 Height, km
% 2 Electron_density_Ne, m-3
% 3 Ratio_of_Ne_to_NmF2

%       1            2      3
A = [60.00 -0.10000E+01 -1.000;
    61.00 -0.10000E+01 -1.000;
    62.00 -0.10000E+01 -1.000;
    63.00 -0.10000E+01 -1.000;
    64.00 -0.10000E+01 -1.000;
    65.00 -0.10000E+01 -1.000;
    66.00 -0.10000E+01 -1.000;
    67.00 -0.10000E+01 -1.000;
    68.00 -0.10000E+01 -1.000;
    69.00 -0.10000E+01 -1.000;
    70.00 -0.10000E+01 -1.000;
    71.00 -0.10000E+01 -1.000;
    72.00 -0.10000E+01 -1.000;
    73.00 -0.10000E+01 -1.000;
    74.00 -0.10000E+01 -1.000;
    75.00 -0.10000E+01 -1.000;
    76.00 -0.10000E+01 -1.000;
    77.00 -0.10000E+01 -1.000;
    78.00 -0.10000E+01 -1.000;
    79.00 -0.10000E+01 -1.000;
    80.00  0.61318E+06  0.000;
    81.00  0.47953E+07  0.000;
    82.00  0.22780E+08  0.000;
    83.00  0.70588E+08  0.001;
    84.00  0.15319E+09  0.002;
    85.00  0.25002E+09  0.003;
    86.00  0.32951E+09  0.004;
    87.00  0.37655E+09  0.004;
    88.00  0.40062E+09  0.005;
    89.00  0.42466E+09  0.005;
    90.00  0.47408E+09  0.006;
    91.00  0.58754E+09  0.007;
    92.00  0.85209E+09  0.010;
    93.00  0.11914E+10  0.014;
    94.00  0.13758E+10  0.016;
    95.00  0.15390E+10  0.018;
    96.00  0.16770E+10  0.020;
    97.00  0.17888E+10  0.021;
    98.00  0.18758E+10  0.022;
    99.00  0.19407E+10  0.023;
    100.00  0.19872E+10  0.024;
    101.00  0.20190E+10  0.024;
    102.00  0.20397E+10  0.024;
    103.00  0.20523E+10  0.024;
    104.00  0.20595E+10  0.025;
    105.00  0.20632E+10  0.025;
    106.00  0.20649E+10  0.025;
    107.00  0.20655E+10  0.025;
    108.00  0.20657E+10  0.025;
    109.00  0.20657E+10  0.025;
    110.00  0.20657E+10  0.025;
    111.00  0.20457E+10  0.024;
    112.00  0.19902E+10  0.024;
    113.00  0.19069E+10  0.023;
    114.00  0.18037E+10  0.021;
    115.00  0.16879E+10  0.020;
    116.00  0.15658E+10  0.019;
    117.00  0.14427E+10  0.017;
    118.00  0.13225E+10  0.016;
    119.00  0.12082E+10  0.014;
    120.00  0.11015E+10  0.013;
    121.00  0.10036E+10  0.012;
    122.00  0.91488E+09  0.011;
    123.00  0.83540E+09  0.010;
    124.00  0.76483E+09  0.009;
    125.00  0.70267E+09  0.008;
    126.00  0.64832E+09  0.008;
    127.00  0.60113E+09  0.007;
    128.00  0.56043E+09  0.007;
    129.00  0.52560E+09  0.006;
    130.00  0.49607E+09  0.006;
    131.00  0.47131E+09  0.006;
    132.00  0.45086E+09  0.005;
    133.00  0.43432E+09  0.005;
    134.00  0.42134E+09  0.005;
    135.00  0.41165E+09  0.005;
    136.00  0.40501E+09  0.005;
    137.00  0.40122E+09  0.005;
    138.00  0.40015E+09  0.005;
    139.00  0.40169E+09  0.005;
    140.00  0.40575E+09  0.005;
    141.00  0.41231E+09  0.005;
    142.00  0.42132E+09  0.005;
    143.00  0.43280E+09  0.005;
    144.00  0.44675E+09  0.005;
    145.00  0.46321E+09  0.006;
    146.00  0.48221E+09  0.006;
    147.00  0.50379E+09  0.006;
    148.00  0.52800E+09  0.006;
    149.00  0.55485E+09  0.007;
    150.00  0.58438E+09  0.007;
    151.00  0.61659E+09  0.007;
    152.00  0.65146E+09  0.008;
    153.00  0.68895E+09  0.008;
    154.00  0.72901E+09  0.009;
    155.00  0.77152E+09  0.009;
    156.00  0.81638E+09  0.010;
    157.00  0.86343E+09  0.010;
    158.00  0.91249E+09  0.011;
    159.00  0.96339E+09  0.011;
    160.00  0.10159E+10  0.012;
    161.00  0.10699E+10  0.013;
    162.00  0.11252E+10  0.013;
    163.00  0.11817E+10  0.014;
    164.00  0.12393E+10  0.015;
    165.00  0.12980E+10  0.015;
    166.00  0.13581E+10  0.016;
    167.00  0.14198E+10  0.017;
    168.00  0.14836E+10  0.018;
    169.00  0.15502E+10  0.018;
    170.00  0.16206E+10  0.019;
    171.00  0.16960E+10  0.020;
    172.00  0.17782E+10  0.021;
    173.00  0.18693E+10  0.022;
    174.00  0.19722E+10  0.024;
    175.00  0.20884E+10  0.025;
    176.00  0.22080E+10  0.026;
    177.00  0.23344E+10  0.028;
    178.00  0.24679E+10  0.029;
    179.00  0.26090E+10  0.031;
    180.00  0.27581E+10  0.033;
    181.00  0.29157E+10  0.035;
    182.00  0.30822E+10  0.037;
    183.00  0.32581E+10  0.039;
    184.00  0.34440E+10  0.041;
    185.00  0.36405E+10  0.043;
    186.00  0.38480E+10  0.046;
    187.00  0.40674E+10  0.048;
    188.00  0.42992E+10  0.051;
    189.00  0.45442E+10  0.054;
    190.00  0.48030E+10  0.057;
    191.00  0.50766E+10  0.060;
    192.00  0.53657E+10  0.064;
    193.00  0.56713E+10  0.068;
    194.00  0.59943E+10  0.071;
    195.00  0.63357E+10  0.076;
    196.00  0.66965E+10  0.080;
    197.00  0.70780E+10  0.084;
    198.00  0.74812E+10  0.089;
    199.00  0.79076E+10  0.094;
    200.00  0.83584E+10  0.100;
    201.00  0.88351E+10  0.105;
    202.00  0.93393E+10  0.111;
    203.00  0.98725E+10  0.118;
    204.00  0.10437E+11  0.124;
    205.00  0.11033E+11  0.131;
    206.00  0.11665E+11  0.139;
    207.00  0.12330E+11  0.147;
    208.00  0.13020E+11  0.155;
    209.00  0.13737E+11  0.164;
    210.00  0.14481E+11  0.173;
    211.00  0.15250E+11  0.182;
    212.00  0.16047E+11  0.191;
    213.00  0.16869E+11  0.201;
    214.00  0.17719E+11  0.211;
    215.00  0.18594E+11  0.222;
    216.00  0.19496E+11  0.232;
    217.00  0.20423E+11  0.243;
    218.00  0.21376E+11  0.255;
    219.00  0.22354E+11  0.266;
    220.00  0.23356E+11  0.278;
    221.00  0.24383E+11  0.291;
    222.00  0.25433E+11  0.303;
    223.00  0.26506E+11  0.316;
    224.00  0.27601E+11  0.329;
    225.00  0.28718E+11  0.342;
    226.00  0.29854E+11  0.356;
    227.00  0.31010E+11  0.370;
    228.00  0.32185E+11  0.384;
    229.00  0.33376E+11  0.398;
    230.00  0.34584E+11  0.412;
    231.00  0.35807E+11  0.427;
    232.00  0.37043E+11  0.441;
    233.00  0.38291E+11  0.456;
    234.00  0.39550E+11  0.471;
    235.00  0.40819E+11  0.486;
    236.00  0.42095E+11  0.502;
    237.00  0.43378E+11  0.517;
    238.00  0.44665E+11  0.532;
    239.00  0.45956E+11  0.548;
    240.00  0.47248E+11  0.563;
    241.00  0.48540E+11  0.578;
    242.00  0.49830E+11  0.594;
    243.00  0.51116E+11  0.609;
    244.00  0.52397E+11  0.624;
    245.00  0.53671E+11  0.640;
    246.00  0.54936E+11  0.655;
    247.00  0.56191E+11  0.670;
    248.00  0.57433E+11  0.684;
    249.00  0.58662E+11  0.699;
    250.00  0.59875E+11  0.714;
    251.00  0.61071E+11  0.728;
    252.00  0.62248E+11  0.742;
    253.00  0.63405E+11  0.756;
    254.00  0.64539E+11  0.769;
    255.00  0.65651E+11  0.782;
    256.00  0.66737E+11  0.795;
    257.00  0.67797E+11  0.808;
    258.00  0.68830E+11  0.820;
    259.00  0.69834E+11  0.832;
    260.00  0.70808E+11  0.844;
    261.00  0.71750E+11  0.855;
    262.00  0.72661E+11  0.866;
    263.00  0.73539E+11  0.876;
    264.00  0.74383E+11  0.886;
    265.00  0.75192E+11  0.896;
    266.00  0.75965E+11  0.905;
    267.00  0.76703E+11  0.914;
    268.00  0.77404E+11  0.922;
    269.00  0.78069E+11  0.930;
    270.00  0.78696E+11  0.938;
    271.00  0.79286E+11  0.945;
    272.00  0.79838E+11  0.951;
    273.00  0.80353E+11  0.958;
    274.00  0.80831E+11  0.963;
    275.00  0.81271E+11  0.969;
    276.00  0.81675E+11  0.973;
    277.00  0.82042E+11  0.978;
    278.00  0.82373E+11  0.982;
    279.00  0.82669E+11  0.985;
    280.00  0.82930E+11  0.988;
    281.00  0.83157E+11  0.991;
    282.00  0.83352E+11  0.993;
    283.00  0.83515E+11  0.995;
    284.00  0.83648E+11  0.997;
    285.00  0.83751E+11  0.998;
    286.00  0.83827E+11  0.999;
    287.00  0.83878E+11  1.000;
    288.00  0.83905E+11  1.000;
    289.00  0.83912E+11  1.000;
    290.00  0.83903E+11  1.000;
    291.00  0.83882E+11  1.000;
    292.00  0.83848E+11  0.999;
    293.00  0.83801E+11  0.999;
    294.00  0.83743E+11  0.998;
    295.00  0.83672E+11  0.997;
    296.00  0.83589E+11  0.996;
    297.00  0.83495E+11  0.995;
    298.00  0.83389E+11  0.994;
    299.00  0.83272E+11  0.992;
    300.00  0.83144E+11  0.991;
    301.00  0.83005E+11  0.989;
    302.00  0.82855E+11  0.987;
    303.00  0.82695E+11  0.986;
    304.00  0.82525E+11  0.983;
    305.00  0.82345E+11  0.981;
    306.00  0.82155E+11  0.979;
    307.00  0.81956E+11  0.977;
    308.00  0.81747E+11  0.974;
    309.00  0.81530E+11  0.972;
    310.00  0.81303E+11  0.969;
    311.00  0.81068E+11  0.966;
    312.00  0.80825E+11  0.963;
    313.00  0.80574E+11  0.960;
    314.00  0.80314E+11  0.957;
    315.00  0.80047E+11  0.954;
    316.00  0.79773E+11  0.951;
    317.00  0.79491E+11  0.947;
    318.00  0.79202E+11  0.944;
    319.00  0.78907E+11  0.940;
    320.00  0.78605E+11  0.937;
    321.00  0.78296E+11  0.933;
    322.00  0.77982E+11  0.929;
    323.00  0.77661E+11  0.926;
    324.00  0.77335E+11  0.922;
    325.00  0.77003E+11  0.918;
    326.00  0.76667E+11  0.914;
    327.00  0.76325E+11  0.910;
    328.00  0.75978E+11  0.905;
    329.00  0.75626E+11  0.901;
    330.00  0.75270E+11  0.897;
    331.00  0.74910E+11  0.893;
    332.00  0.74546E+11  0.888;
    333.00  0.74178E+11  0.884;
    334.00  0.73806E+11  0.880;
    335.00  0.73430E+11  0.875;
    336.00  0.73052E+11  0.871;
    337.00  0.72670E+11  0.866;
    338.00  0.72285E+11  0.861;
    339.00  0.71897E+11  0.857;
    340.00  0.71507E+11  0.852;
    341.00  0.71114E+11  0.847;
    342.00  0.70718E+11  0.843;
    343.00  0.70321E+11  0.838;
    344.00  0.69922E+11  0.833;
    345.00  0.69520E+11  0.828;
    346.00  0.69117E+11  0.824;
    347.00  0.68713E+11  0.819;
    348.00  0.68307E+11  0.814;
    349.00  0.67899E+11  0.809;
    350.00  0.67491E+11  0.804;
    351.00  0.67081E+11  0.799;
    352.00  0.66671E+11  0.795;
    353.00  0.66260E+11  0.790;
    354.00  0.65848E+11  0.785;
    355.00  0.65435E+11  0.780;
    356.00  0.65023E+11  0.775;
    357.00  0.64609E+11  0.770;
    358.00  0.64196E+11  0.765;
    359.00  0.63783E+11  0.760;
    360.00  0.63369E+11  0.755;
    361.00  0.62956E+11  0.750;
    362.00  0.62543E+11  0.745;
    363.00  0.62130E+11  0.740;
    364.00  0.61717E+11  0.736;
    365.00  0.61305E+11  0.731;
    366.00  0.60894E+11  0.726;
    367.00  0.60483E+11  0.721;
    368.00  0.60073E+11  0.716;
    369.00  0.59664E+11  0.711;
    370.00  0.59255E+11  0.706;
    371.00  0.58848E+11  0.701;
    372.00  0.58442E+11  0.696;
    373.00  0.58036E+11  0.692;
    374.00  0.57632E+11  0.687;
    375.00  0.57229E+11  0.682;
    376.00  0.56828E+11  0.677;
    377.00  0.56427E+11  0.672;
    378.00  0.56028E+11  0.668;
    379.00  0.55631E+11  0.663;
    380.00  0.55235E+11  0.658;
    381.00  0.54840E+11  0.654;
    382.00  0.54448E+11  0.649;
    383.00  0.54056E+11  0.644;
    384.00  0.53667E+11  0.640;
    385.00  0.53279E+11  0.635;
    386.00  0.52893E+11  0.630;
    387.00  0.52509E+11  0.626;
    388.00  0.52126E+11  0.621;
    389.00  0.51746E+11  0.617;
    390.00  0.51367E+11  0.612;
    391.00  0.50991E+11  0.608;
    392.00  0.50616E+11  0.603;
    393.00  0.50243E+11  0.599;
    394.00  0.49872E+11  0.594;
    395.00  0.49504E+11  0.590;
    396.00  0.49137E+11  0.586;
    397.00  0.48773E+11  0.581;
    398.00  0.48410E+11  0.577;
    399.00  0.48050E+11  0.573;
    400.00  0.47692E+11  0.568];


netemp = A(:,2);
netemp(netemp < 0) = 0;
h = A(:,1);

ne = interp1(h,netemp,alt,'cubic');

fi = find(ne > 0,1,'first');
logne = interp1([1 fi],[-5 log10(ne(fi))],1:fi,'linear');
ne(1:fi) = 10.^(logne);

