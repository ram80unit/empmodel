function r=air1(e,h,i)

%	function r=air1(e,h,i)
%
%	Calculates excitation coefficients of various excited states
%	produced by electron impact in air (N2:78.11%, O2:20.91%, Ar:0.98%).
%	Also calculates electron mobility and mean electron energy.
%
%	r - excitation coefficient in 1/s, or mobility in m^2/V/s, or mean energy in eV;
%	e - array electric field in V/m (0<e*no/n<6.3e7 V/m, where no=2.688e19 cm-3);
%	h - altitude in km (h>150 km is intepreted as neutral density n in cm-3);
%	i - integer parameter specifying process to be calculated:
%
%	1 Mean energy                       14 N2 (v=2)
%	2 Two body attachment               15 N2 (v=3)
%	3 LBH UV N2	(a^1 Pi_g)              16 N2 (v=4)
%	4 IR ATM O2	(a^1 Delta_g)           17 N2 (v=5)
%	5 1st positive N2 (B^3 Pi_g)        18 N2 (v=6)
%	6 2nd positive N2 (C^3 Pi_u)        19 N2 (v=7)
%	7 1st negative N2+ (B^2 Sigma_u^+)  20 N2 (v=8)
%	8 1st negative O2+ (b^4 Sigma_g^-)  21 CO2(v,.291 eV)
%	9 Meinel N2+ (A^2 Pi_u)             22 1st negative N2+ (B^2 Sigma_u^+)
%	10 Ionization                       23 1st negative N2+ (B^2 Sigma_u^+) (rec)
%	11 Mobility                         24 Meinel N2+ (A^2 Pi_u) (rec)
%	12 N2 (v=1, .29 eV)                 25 1st negative O2+ (b^4 Sigma_g^-) (rec)
%	13 N2 (v=1, .291 eV)                26 N2(v) total
%
%		- 7, 8 and 9 use ionization cross sections with branching
%         ratios of Rees [1989];
%		- 22 uses Phelps'[1997] cross section for 1st negative of N2+;
%		- 23, 24 and 25 (recommended) use modified ionization cross sections with
%			threshold energies adjusted to fit the thresholds of the corresponding
%			processes;
%		  23 and 24 use brancing ratios of Van Zyl and Pendleton [1995];
%		  25 uses branching ratios of Rees [1989].
%     - 21 uses density of CO2=3.e-4n.
%
%	The function is created by Georgios Veronis and Victor Pasko (STAR Lab,
%	Stanford University) on February 23, 1999 and is based on analytical
%	polynomial fits to results  of calculations obtained with ELENDIF
%	Boltzmann code [Morgan and  Penetrante, 1990] using set of cross
%	sections of Phelps [Phelps and Pitchford, 1985; Phelps, 1987;
%	Phelps, 1997].
%
%   The function was then modified on January 26, 2005 by Gregory Moss
%   (CSSL, Pennsylvania State University) to eliminate errors introduced 
%   by poor performance of the analytical polynomial fits.  The function 
%   is now based on a linear interpolation and extrapolation of the 
%   results obtained with the ELENDIF Boltzmann code [Morgan and Penetrante, 
%   1990] using set of cross sections of Phelps [Phelps and Pitchford, 
%   1985; Phelps, 1987; Phelps, 1997].
%
%   This MATLAB function is provided as is and we do not guarantee or
%   assume any responsibility for the accuracy, completeness, 
%   or usefulness of any information provided herein and derived from
%   subsequent calculations. If you use this function in your research 
%   please refer to the following paper in your publications:
%
%    Moss, G. D., V. P. Pasko, N. Liu, and G. Veronis, Monte Carlo model 
%    for analysis of thermal runaway electrons in streamer tips in transient 
%    luminous events and streamer zones of lightning leaders, 
%    Journal of Geophysical Research, 111, A02307, doi:10.1029/2005JA011350, 2006
%   (A copy is available at http://www.ee.psu.edu/faculty/pasko/pasko2.html)
%
%    The above listed paper by Moss et al. [2006] provides extensive comparisons 
%    of the results derived from this function with available experimental
%    data, Monte Carlo modeling, and other similar models published in refereed literature. 
%
%    Please send your comments to Victor Pasko (vpasko@psu.edu)
%
%	References:
%	- Morgan, W.L., and B.M. Penetrante, Computer Phys. Comm., 58, 127, 1990.
%	- Phelps, A.V., and Pitchford, Physical Review A, 31, 2932, 1985
%	- Phelps, A.V., in Gaseous Dielectrics V. 5, Edited by L.C. Christophoru and
%    D.W. Bouldin, page 1, 1987.
%	- Phelps, A.V., http://jila.colorado.edu/collision_data, last revision 1997.
%     (Most recent version is available at
%     http://jilawww.colorado.edu/www/research/colldata.html)
%	- Rees, M.H., Physics and Chemistry of the upper atmosphere, Cambridge University
%	  Press, New York, 1989.
%	- Van Zyl, B., and W. Pendleton Jr., J. Geophys. Res., 100, 23755, 1995.


%Define some constants:
n0=2.688e19; %neutral density at the ground at temperature 273 deg. K
log_emax=7.8; %log of max electric field (above this value results may not be correct)
field = 10.^(2:0.05:7.8);

%For processes 1 (mean energy), 11 (mobility), 12 (N2(v=1)), 21 (CO2(v)) and 26 (sum N2(v))
%we have nonzero outputs even when input field is zero (due to assumed ambient
%temperature 273 K). In our calculations we assume that 100 V/m at ground level
%is the cutoff field below which effects of electron heating are not important.
%We use values correspoding to 100 V/m as stationary values everywhere between
%0 and 100 V/m. For mean energy, for example, this approach agrees within ~8%
%with 3/2 kT estimate for 273K (3/2*273/11600 ~0.035 eV). For mobility
%we have good agreements with mobility of thermal electrons shown in Figure 11 of
%Davies, D.K, Measurements of swarm parameters in dry air, Westinghouse electric
%corporation, Technical notes, Note 346, 1983.

eng0=0.037717; 	%eV      (1)
mob0=1.4856;  	%m2/V/s (11)
N2v10=1987.2;	%1/s   	(12)
CO2v0=861.76;	%1/s	(21)
N2sv0=1987.2;    %1/s	(26)

%Determine ratio of neutral density n to n0:

if(0<=h && h<150), %means input is altitude in km

%US Standard Atmosphere:
%We replaced original 2.5e19cm-3 at 0 km altitude
%by 2.688e19 cm-3 which is our reference
%number density at temperature 273 K.
%statm(1,:) altitude in km
%statm(2,:) neutral density in cm-3

statm=[
 0e+0	 2.688e+19
 5e+0	 1.53e+19
 1e+1	 8.59e+18
 1.5e+1	 4.05e+18
 2e+1	 1.85e+18
 2.5e+1	 8.33e+17
 3e+1	 3.83e+17
 3.5e+1	 1.76e+17
 4e+1	 8.31e+16
 4.5e+1	 4.088e+16
 5e+1	 2.13e+16
 5.5e+1	 1.181e+16
 6e+1	 6.33e+15
 6.4e+1	 3.93e+15
 6.8e+1	 2.39e+15
 7.2e+1	 1.39e+15
 7.6e+1	 7.72e+14
 8e+1	 4.03e+14
 8.4e+1	 1.99e+14
 8.8e+1	 9.48e+13
 9.2e+1	 4.37e+13
 9.6e+1	 2.07e+13
 1e+2	 1.04e+13
 1.08e+2	 3.18e+12
 1.14e+2	 1.43e+12
 1.2e+2	 6.61e+11
 1.26e+2	 3.4e+11
 1.32e+2	 1.91e+11
 1.4e+2	 9.7e+10
 1.5e+2	 4.92e+10
];
	n_n0=10^(interp1q(statm(:,1),log10(statm(:,2)),h))/n0;
else%means input is neutral density
	n_n0=h/n0;
end %if

%Normalized electric field in V/m
ef=e/n_n0;
logef=log10(ef);

%Table of Results based on Elendif Outputs
table = [
0.037717	0	0	2.7924e-11	0	0	0	0	0	0	1.4856	1987.2	0	0	0	0	0	0	0	0	861.76	0	0	0	0	1987.2
0.038392	0	0	2.9085e-11	0	0	0	0	0	0	1.4434	2065.7	0	0	0	0	0	0	0	0	895.81	0	0	0	0	2065.7
0.039158	0	0	3.0513e-11	0	0	0	0	0	0	1.3995	2161.7	0	0	0	0	0	0	0	0	937.37	0	0	0	0	2161.7
0.040021	0	0	3.2276e-11	0	0	0	0	0	0	1.3543	2279.1	0	0	0	0	0	0	0	0	988.24	0	0	0	0	2279.1
0.04099	0	0	3.4465e-11	0	0	0	0	0	0	1.308	2423.6	0	0	0	0	0	0	0	0	1050.8	0	0	0	0	2423.6
0.042072	0	0	3.7197e-11	0	0	0	0	0	0	1.2609	2601.8	0	0	0	0	0	0	0	0	1128	0	0	0	0	2601.8
0.043278	0	0	4.0636e-11	0	0	0	0	0	0	1.2134	2823.3	0	0	0	0	0	0	0	0	1223.8	0	0	0	0	2823.3
0.044616	0	0	4.4998e-11	0	0	0	0	0	0	1.1656	3099.9	0	0	0	0	0	0	0	0	1343.5	0	0	0	0	3099.9
0.046098	0	0	5.0589e-11	0	0	0	0	0	0	1.118	3447.9	0	0	0	0	0	0	0	0	1494	0	0	0	0	3447.9
0.047738	0	0	5.7836e-11	0	0	0	0	0	0	1.0707	3889.4	0	0	0	0	0	0	0	0	1684.9	0	0	0	0	3889.4
0.049551	0	0	6.7353e-11	0	0	0	0	0	0	1.0239	4454.5	0	0	0	0	0	0	0	0	1928.9	0	0	0	0	4454.5
0.051559	0	0	8.0025e-11	0	0	0	0	0	0	0.97778	5184.4	0	0	0	0	0	0	0	0	2244	0	0	0	0	5184.4
0.053783	0	0	9.7149e-11	0	0	0	0	0	0	0.93243	6136.5	0	0	0	0	0	0	0	0	2654.4	0	0	0	0	6136.5
0.056254	0	0	1.2066e-10	0	0	0	0	0	0	0.88787	7391.2	0	0	0	0	0	0	0	0	3194.6	0	0	0	0	7391.2
0.058998	0	0	1.5346e-10	0	0	0	0	0	0	0.84414	9062	0	0	0	0	0	0	0	0	3912.8	0	0	0	0	9062
0.062045	0	0	1.9995e-10	0	0	0	0	0	0	0.80124	11312	0	0	0	0	0	0	0	0	4878.2	0	0	0	0	11312
0.065421	0	0	2.6692e-10	0	0	0	0	0	0	0.75925	14382	0	0	0	0	0	0	0	0	6192.5	0	0	0	0	14382
0.069137	0	0	3.6485e-10	0	0	0	0	0	0	0.71832	18627	0	0	0	0	0	0	0	0	8007.1	0	0	0	0	18627
0.073199	0	0	5.1019e-10	0	0	0	0	0	0	0.67866	24597	0	0	0	0	0	0	0	0	10555	0	0	0	0	24597
0.077594	0	0	7.2884e-10	0	0	0	0	0	0	0.64053	33140	0	0	0	0	0	0	0	0	14199	0	0	0	0	33140
0.082295	0	0	1.0616e-09	0	0	0	0	0	0	0.60424	45556	0	0	0	0	0	0	0	0	19497	0	0	0	0	45556
0.087261	0	0	1.5731e-09	0	0	0	0	0	0	0.57006	63803	0	0	0	0	0	0	0	0	27293	0	0	0	0	63803
0.092437	0	0	2.3647e-09	0	0	0	0	0	0	0.53819	90687	0	0	0	0	0	0	0	0	38805	0	0	0	0	90687
0.097754	0	0	3.5964e-09	0	0	0	0	0	0	0.5088	1.2999e+05	0	0	0	0	0	0	0	0	55684	0	0	0	0	1.2999e+05
0.10313	0	0	5.5216e-09	0	0	0	0	0	0	0.48195	1.8646e+05	0	0	0	0	0	0	0	0	80004	0	0	0	0	1.8646e+05
0.10847	0	0	8.5495e-09	0	0	0	0	0	0	0.45768	2.655e+05	0	0	0	0	0	0	0	0	1.1414e+05	0	0	0	0	2.655e+05
0.11367	0	0	1.3365e-08	0	0	0	0	0	0	0.43598	3.7287e+05	0	0	0	0	0	0	0	0	1.6061e+05	0	0	0	0	3.7287e+05
0.11864	0	0	2.1171e-08	0	0	0	0	0	0	0.41678	5.1436e+05	0	0	0	0	0	0	0	0	2.2188e+05	0	0	0	0	5.1436e+05
0.12331	0	0	3.4229e-08	0	0	0	0	0	0	0.39993	6.9608e+05	0	0	0	0	0	0	0	0	3.0046e+05	0	0	0	0	6.9608e+05
0.12762	0	0	5.7079e-08	0	0	0	0	0	0	0.3853	9.2505e+05	0	0	0	0	0	0	0	0	3.9908e+05	0	0	0	0	9.2505e+05
0.13159	0	0	9.962e-08	0	0	0	0	0	0	0.37262	1.2106e+06	0	0	0	0	0	0	0	0	5.2128e+05	0	0	0	0	1.2106e+06
0.13524	0	0	1.8526e-07	0	0	0	0	0	0	0.36164	1.5654e+06	0	0	0	0	0	0	0	0	6.717e+05	0	0	0	0	1.5654e+06
0.13864	0	0	3.7431e-07	0	0	0	0	0	0	0.35207	2.0065e+06	0	0	0	0	0	0	0	0	8.5659e+05	0	0	0	0	2.0065e+06
0.14187	0	0	8.3583e-07	0	0	0	0	0	0	0.34365	2.5551e+06	0	0	0	0	0	0	0	0	1.0837e+06	0	0	0	0	2.5551e+06
0.14503	0	0	2.0911e-06	0	0	0	0	0	0	0.33608	3.237e+06	0	0	0	0	0	0	0	0	1.3624e+06	0	0	0	0	3.237e+06
0.14823	0	0	5.9476e-06	0	0	0	0	0	0	0.32911	4.0821e+06	0	0	0	0	0	0	0	0	1.7033e+06	0	0	0	0	4.0821e+06
0.15156	0	0	1.9591e-05	0	0	0	0	0	0	0.32251	5.1233e+06	0	0	0	0	0	0	0	0	2.1176e+06	0	0	0	0	5.1233e+06
0.15513	0	0	7.5717e-05	0	0	0	0	0	0	0.31608	6.3958e+06	0	0	0	0	0	0	0	0	2.6167e+06	0	0	0	0	6.3958e+06
0.15902	0	0	0.00033947	0	0	0	0	0	0	0.30963	7.9391e+06	0	0	0	0	0	0	0	0	3.2128e+06	0	0	0	0	7.9391e+06
0.16332	0	0	0.0016881	0	0	0	0	0	0	0.30306	9.7934e+06	0	0	0	0	0	0	0	0	3.9164e+06	0	0	0	0	9.7934e+06
0.16809	0	0	0.0087198	0	0	0	0	0	0	0.29627	1.2e+07	0	0	0	0	0	0	0	0	4.7373e+06	0	0	0	0	1.2e+07
0.17475	3.9362e-26	0	0.26417	0	0	0	0	0	0	0.2897	1.5145e+07	4.6381e-07	2.42e-10	1.4771e-12	4.2695e-15	2.116e-16	5.6086e-20	2.088e-21	7.5657e-22	5.8837e+06	0	0	0	0	1.5145e+07
0.18066	3.9362e-26	0	1.4312	0	0	0	0	0	0	0.28219	1.8204e+07	8.7316e-06	4.3456e-09	2.5779e-11	7.1713e-14	3.678e-15	8.7766e-19	1.1267e-20	7.4745e-22	6.9698e+06	0	0	0	0	1.8204e+07
0.18714	3.9362e-26	0	7.2424	0	0	0	0	0	0	0.27448	2.173e+07	0.00017621	7.9251e-08	4.857e-10	1.1953e-12	6.3213e-14	1.4415e-17	1.6576e-19	7.651e-22	8.1831e+06	0	0	0	0	2.173e+07
0.19424	3.9362e-26	0	33.762	0	0	0	0	0	0	0.26662	2.5782e+07	0.0034481	1.4715e-06	9.1896e-09	2.0148e-11	1.0009e-12	2.4081e-16	2.7023e-18	1.5049e-21	9.5256e+06	0	0	0	0	2.5782e+07
0.20202	3.9362e-26	0	144.04	0	0	0	0	0	0	0.25868	3.0427e+07	0.059878	2.7597e-05	1.5999e-07	3.4837e-10	1.4217e-11	4.0499e-15	4.4262e-17	1.5742e-20	1.0999e+07	0	0	0	0	3.0427e+07
0.21058	3.9362e-26	0	561.04	0	0	0	0	0	0	0.25068	3.576e+07	0.87677	0.00049921	2.4169e-06	5.9305e-09	1.8504e-10	6.5848e-14	7.1762e-16	2.3834e-19	1.2603e+07	0	0	0	0	3.576e+07
0.22006	3.149e-26	0	1995.2	0	0	0	0	0	0	0.24267	4.1908e+07	10.587	0.0081818	3.0969e-05	9.2201e-08	2.329e-09	9.7837e-13	1.1029e-14	3.2244e-18	1.4339e+07	0	0	0	0	4.1908e+07
0.23066	3.149e-26	0	6487.3	0	0	0	0	0	0	0.23465	4.9064e+07	104.82	0.11591	0.0003395	1.2325e-06	2.9376e-08	1.2688e-11	1.5231e-13	3.7469e-17	1.6204e+07	0	0	0	0	4.9064e+07
0.24266	3.149e-26	0	19329	0	0	0	0	0	0	0.22661	5.755e+07	853.37	1.3859	0.0033129	1.3741e-05	3.6031e-07	1.3994e-10	1.8188e-12	3.7613e-16	1.8195e+07	0	0	0	0	5.7551e+07
0.25647	3.149e-26	0	52912	0	0	0	0	0	0	0.21852	6.7945e+07	5757.7	13.876	0.030681	0.00012665	4.017e-06	1.3008e-09	1.8429e-11	3.334e-15	2.0304e+07	0	0	0	0	6.7951e+07
0.27261	3.149e-26	0	1.3344e+05	0	0	0	0	0	0	0.21033	8.1316e+07	32518	116.4	0.28362	0.00096943	3.8611e-05	1.0237e-08	1.5768e-10	2.6931e-14	2.2518e+07	0	0	0	0	8.1349e+07
0.29176	3.9362e-26	0	3.1089e+05	0	0	0	0	0	0	0.20197	9.96e+07	1.5542e+05	821.43	2.5897	0.0062526	0.00031202	6.925e-08	1.143e-09	2.0384e-13	2.4818e+07	0	0	0	0	9.9756e+07
0.31476	3.149e-26	0	6.7086e+05	0	0	0	0	0	0	0.19335	1.2611e+08	6.3565e+05	4903.4	22.053	0.034891	0.002107	4.1322e-07	7.085e-09	1.4575e-12	2.7179e+07	0	0	0	0	1.2675e+08
0.34242	3.9362e-26	0	1.344e+06	0	0	0	0	0	0	0.18443	1.6601e+08	2.2482e+06	24910	165.96	0.17604	0.011943	2.2499e-06	3.8135e-08	9.694e-12	2.9561e+07	0	0	0	0	1.6829e+08
0.37542	3.9362e-26	0	2.5064e+06	0	0	0	0	0	0	0.17517	2.2643e+08	6.9469e+06	1.0842e+05	1071.7	0.85562	0.057503	1.1575e-05	1.8259e-07	5.8502e-11	3.1917e+07	0	0	0	0	2.3349e+08
0.41405	3.149e-26	0	4.3625e+06	0	0	0	0	0	0	0.16561	3.1577e+08	1.8939e+07	4.0739e+05	5879	4.2521	0.24045	5.7611e-05	8.0594e-07	3.142e-10	3.4186e+07	0	0	0	0	3.3512e+08
0.45798	3.149e-26	0	7.1106e+06	0	0	0	0	0	0	0.15586	4.4198e+08	4.5996e+07	1.3327e+06	27423	21.857	0.91197	0.0002788	3.4284e-06	1.4908e-09	3.6308e+07	0	0	0	0	4.8933e+08
0.50625	3.9362e-26	0	1.0899e+07	0	0	0	0	0	0	0.1461	6.1024e+08	1.0054e+08	3.8339e+06	1.0956e+05	111.52	3.4082	0.0013016	1.4599e-05	6.2887e-09	3.8226e+07	0	0	0	0	7.1472e+08
0.55731	5.5107e-26	0	1.5783e+07	0	0	0	0	0	0	0.13655	8.2063e+08	1.9978e+08	9.8006e+06	3.7878e+05	536.18	14.015	0.0058275	6.3112e-05	2.4158e-08	3.9899e+07	0	0	0	0	1.0306e+09
0.60939	2.5192e-25	0	2.1714e+07	0	0	0	0	0	0	0.12743	1.0675e+09	3.6475e+08	2.2522e+07	1.1475e+06	2352.4	66.444	0.025435	0.00027711	8.9694e-08	4.1311e+07	0	0	0	0	1.4559e+09
0.64621	2.112e-18	7.4331e-18	2.7352e+07	4.9888e-17	0	0	0	0	0	0.1227	1.2863e+09	5.7826e+08	4.3729e+07	2.832e+06	9145.3	381.53	0.17988	0.0021371	6.9764e-07	4.1691e+07	0	0	0	0	1.9111e+09
0.69714	8.5494e-19	2.7624e-18	3.4751e+07	1.854e-17	0	0	0	0	0	0.11424	1.5694e+09	9.2557e+08	8.4737e+07	6.9156e+06	32418	1823.6	0.85464	0.010474	3.8923e-06	4.2794e+07	0	0	0	0	2.5867e+09
0.74471	2.8519e-17	7.9546e-19	4.2626e+07	5.3471e-18	0	0	0	0	0	0.10664	1.8526e+09	1.4009e+09	1.526e+08	1.5388e+07	1.0446e+05	8056.2	4.8336	0.063106	3.1057e-05	4.3655e+07	0	0	0	0	3.4217e+09
0.78826	6.0149e-15	8.832e-20	5.0745e+07	7.6323e-17	0	0	0	0	0	0.099903	2.1238e+09	2.0224e+09	2.5802e+08	3.1577e+07	3.0852e+05	32176	30.566	0.45576	0.00034973	4.4313e+07	0	0	0	0	4.4361e+09
0.82754	1.2833e-12	7.7257e-17	5.8906e+07	3.6425e-14	0	0	0	0	0	0.093974	2.3734e+09	2.8057e+09	4.1352e+08	6.0429e+07	8.4241e+05	1.1555e+05	192.88	3.4675	0.0047455	4.4808e+07	0	0	0	0	5.654e+09
0.86259	2.1317e-10	4.4372e-14	6.6951e+07	1.2254e-11	0	0	0	0	0	0.088779	2.5958e+09	3.765e+09	6.3333e+08	1.0891e+08	2.1432e+06	3.7384e+05	1126.1	25.072	0.064102	4.5176e+07	0	0	0	0	7.1055e+09
0.89365	2.406e-08	1.4925e-11	7.4767e+07	2.5693e-09	0	0	0	0	0	0.084238	2.7878e+09	4.9137e+09	9.3351e+08	1.8645e+08	5.1126e+06	1.095e+06	5879.8	163.97	0.77111	4.5446e+07	0	0	0	0	8.8276e+09
0.92107	1.7757e-06	2.8848e-09	8.2286e+07	3.2687e-07	0	0	0	0	0	0.080268	2.949e+09	6.2648e+09	1.3321e+09	3.0538e+08	1.149e+07	2.9231e+06	27152	951.38	7.8899	4.5642e+07	0	0	0	0	1.0866e+10
0.94524	8.6101e-05	3.2751e-07	8.9477e+07	2.5617e-05	0	0	0	0	0	0.076795	3.0806e+09	7.8313e+09	1.849e+09	4.8136e+08	2.4409e+07	7.1623e+06	1.1078e+05	4867.7	67.637	4.5782e+07	0	0	0	0	1.3274e+10
0.96657	0.0028031	2.266e-05	9.6346e+07	0.0012756	0	0	0	0	0	0.07375	3.185e+09	9.6267e+09	2.506e+09	7.337e+08	4.9161e+07	1.6229e+07	4.0106e+05	21977	485.22	4.5882e+07	0	0	0	0	1.6117e+10
0.98548	0.063048	0.00099621	1.0293e+08	0.041874	0	0	0	0	0	0.071071	3.2648e+09	1.1666e+10	3.3262e+09	1.0854e+09	9.4093e+07	3.4259e+07	1.297e+06	87920	2929.5	4.5951e+07	0	0	0	0	1.9472e+10
1.0024	1.0104	0.029031	1.0929e+08	0.94139	0	0	0	0	0	0.068704	3.3229e+09	1.3964e+10	4.3335e+09	1.563e+09	1.7156e+08	6.7843e+07	3.7767e+06	3.1358e+05	15025	4.5997e+07	0	0	0	0	2.3427e+10
1.0176	11.908	0.5844	1.1551e+08	15.055	0	0	0	0	0	0.066599	3.3622e+09	1.6543e+10	5.5521e+09	2.1956e+09	2.9875e+08	1.2684e+08	9.9845e+06	1.0043e+06	66200	4.6026e+07	0	0	0	0	2.8089e+10
1.0316	106.38	8.4471	1.2171e+08	177.54	0	0	0	0	0	0.06471	3.3853e+09	1.9425e+10	7.0067e+09	3.0143e+09	4.9822e+08	2.2522e+08	2.4166e+07	2.9099e+06	2.5361e+05	4.6041e+07	0	0	0	0	3.3582e+10
1.0448	741.71	90.883	1.2804e+08	1596.9	0	0	0	0	0	0.062997	3.3944e+09	2.2642e+10	8.7218e+09	4.0505e+09	7.9791e+08	3.8167e+08	5.3969e+07	7.685e+06	8.5483e+05	4.6046e+07	0	0	0	0	4.005e+10
1.0575	4144.4	751.92	1.3472e+08	11295	0	0	0	0	0	0.061421	3.3916e+09	2.623e+10	1.0724e+10	5.3353e+09	1.2308e+09	6.2011e+08	1.1204e+08	1.8633e+07	2.5641e+06	4.6042e+07	0	0	0	0	4.7665e+10
1.0703	19029	4928.6	1.4211e+08	64613	0	0	0	0	0	0.059947	3.3787e+09	3.0235e+10	1.304e+10	6.8979e+09	1.8337e+09	9.6966e+08	2.1765e+08	4.176e+07	6.9162e+06	4.6031e+07	0	0	0	0	5.6621e+10
1.0841	73373	26262	1.5095e+08	3.0618e+05	0	0	0	0	0	0.058545	3.3576e+09	3.4706e+10	1.5701e+10	8.765e+09	2.6461e+09	1.4641e+09	3.9805e+08	8.7045e+07	1.6933e+07	4.6013e+07	0	0	0	0	6.7142e+10
1.1002	2.4253e+05	1.1651e+05	1.6279e+08	1.2288e+06	0	0	0	0	0	0.057186	3.3307e+09	3.9696e+10	1.8739e+10	1.0959e+10	3.7073e+09	2.1407e+09	6.889e+08	1.6967e+08	3.7941e+07	4.5989e+07	0	0	0	0	7.9469e+10
1.1213	6.9923e+05	4.3897e+05	1.8071e+08	4.2533e+06	0	0	0	0	0	0.055845	3.3016e+09	4.5247e+10	2.218e+10	1.3494e+10	5.0528e+09	3.037e+09	1.1331e+09	3.1073e+08	7.8345e+07	4.5959e+07	0	0	0	0	9.3835e+10
1.1754	2.4639e+06	2.8281e+06	2.2153e+08	1.8689e+07	5.0628e+05	18.774	1247.6	66.563	8488.2	0.055597	3.0747e+09	6.4496e+10	2.4964e+10	1.7004e+10	6.9101e+09	4.6462e+09	1.8651e+09	6.7104e+08	2.0076e+08	4.5089e+07	0.087267	0.73778	37.25	0.12588	1.2383e+11
1.2256	5.0811e+06	7.8481e+06	2.7624e+08	4.6263e+07	1.9825e+06	149.47	5401.3	529.93	37367	0.054444	3.0712e+09	7.2244e+10	2.9357e+10	2.0268e+10	8.9183e+09	6.142e+09	2.738e+09	1.0264e+09	3.3626e+08	4.5073e+07	1.2491	9.76	346.59	1.6064	1.441e+11
1.3031	9.7235e+06	1.9948e+07	3.6377e+08	1.0569e+08	6.8552e+06	979.81	20530	3473.9	1.4577e+05	0.053226	3.1012e+09	7.9989e+10	3.4189e+10	2.3793e+10	1.1232e+10	7.9147e+09	3.8752e+09	1.51e+09	5.3561e+08	4.507e+07	13.809	99.724	2596.9	16.02	1.6614e+11
1.4195	1.7303e+07	4.6604e+07	4.9744e+08	2.2336e+08	2.1054e+07	5370	69116	19039	5.0959e+05	0.051946	3.1827e+09	8.7332e+10	3.932e+10	2.7431e+10	1.3776e+10	9.9182e+09	5.2767e+09	2.1313e+09	8.0987e+08	4.5086e+07	120.47	804.5	15951	127.4	1.8918e+11
1.5863	2.8683e+07	1.0038e+08	6.8962e+08	4.375e+08	5.7734e+07	24939	2.0769e+05	88420	1.6113e+06	0.050619	3.3348e+09	9.3776e+10	4.4497e+10	3.0967e+10	1.6418e+10	1.2056e+10	6.8987e+09	2.8791e+09	1.1607e+09	4.5133e+07	845.62	5225.8	81600	822.91	2.1199e+11
1.8117	4.4369e+07	1.9989e+08	9.4759e+08	7.9563e+08	1.4206e+08	99338	5.6092e+05	3.522e+05	4.6426e+06	0.049263	3.5723e+09	9.8795e+10	4.9376e+10	3.4141e+10	1.8975e+10	1.4182e+10	8.6464e+09	3.716e+09	1.5757e+09	4.5217e+07	4859.2	27824	3.5266e+05	4388.3	2.3298e+11
2.1078	6.4184e+07	3.6911e+08	1.2691e+09	1.3461e+09	3.1522e+08	3.4311e+05	1.3703e+06	1.2165e+06	1.2254e+07	0.047906	3.9004e+09	1.0197e+11	5.3577e+10	3.67e+10	2.1246e+10	1.6131e+10	1.0386e+10	4.581e+09	2.0273e+09	4.5352e+07	0.1977e5	0.1053e+06	0.1139e+07	.1681e+05  2.5052e+11
2.4554	8.7128e+07	6.346e+08	1.6408e+09	2.1256e+09	6.3449e+08	1.0389e+06	3.0488e+06	3.6835e+06	2.977e+07	0.046577	4.3108e+09	1.0312e+11	5.6787e+10	3.8463e+10	2.306e+10	1.775e+10	1.1972e+10	5.4017e+09	2.4778e+09	4.5504e+07	0.8047e+05	0.3985e+06	0.3679e+07	0.6439e+05	2.6334e+11
2.8189	1.1203e+08	1.0283e+09	2.0471e+09	3.1678e+09	1.1759e+09	2.8148e+06	6.2779e+06	9.9799e+06	6.7442e+07	0.045268	4.7922e+09	1.0224e+11	5.8793e+10	3.9339e+10	2.4301e+10	1.8927e+10	1.328e+10	6.1102e+09	2.8886e+09	4.5673e+07	3.2751e+05	1.508e+06	1.1883e+07	2.4666e+05	2.7067e+11
3.2301	1.3701e+08	1.5761e+09	2.463e+09	4.4705e+09	2.0171e+09	6.8823e+06	1.2029e+07	2.4401e+07	1.4276e+08	0.044007	5.3192e+09	9.9663e+10	5.9581e+10	3.9379e+10	2.4949e+10	1.9628e+10	1.4236e+10	6.6611e+09	3.2292e+09	4.5856e+07	1.0029e+06	4.3133e+06	3.0223e+07	7.1934e+05	2.7265e+11
3.6614	1.6087e+08	2.3114e+09	2.8736e+09	6.0403e+09	3.2475e+09	1.5464e+07	2.1765e+07	5.4828e+07	2.8569e+08	0.042776	5.8785e+09	9.57e+10	5.9214e+10	3.8672e+10	2.5029e+10	1.986e+10	1.481e+10	7.0301e+09	3.481e+09	4.6029e+07	2.7508e+06	1.1079e+07	7.0161e+07	1.888e+06	2.6967e+11
4.1068	1.8252e+08	3.2678e+09	3.2658e+09	7.87e+09	4.9531e+09	3.234e+07	3.7549e+07	1.1466e+08	5.4432e+08	0.041566	6.4588e+09	9.0727e+10	5.7847e+10	3.7357e+10	2.4617e+10	1.9674e+10	1.5017e+10	7.2163e+09	3.6377e+09	4.6179e+07	6.8648e+06	2.5959e+07	1.5072e+08	4.5275e+06	2.6255e+11
4.5622	2.0112e+08	4.4764e+09	3.6298e+09	9.9396e+09	7.206e+09	6.3538e+07	6.2202e+07	2.2527e+08	9.9229e+08	0.040375	7.0525e+09	8.5121e+10	5.5694e+10	3.5598e+10	2.3813e+10	1.9147e+10	1.4902e+10	7.2366e+09	3.7037e+09	4.6293e+07	1.5777e+07	5.6168e+07	3.0274e+08	1.0035e+07	2.5227e+11
5.0267	2.1611e+08	5.9642e+09	3.9591e+09	1.2218e+10	1.0054e+10	1.1816e+08	9.9474e+07	4.1895e+08	1.7374e+09	0.0392	7.6572e+09	7.9214e+10	5.2983e+10	3.3551e+10	2.2728e+10	1.8367e+10	1.4529e+10	7.1188e+09	3.6907e+09	4.6359e+07	3.3718e+07	1.1333e+08	5.733e+08	2.0751e+07	2.3984e+11
5.5024	2.2723e+08	7.7536e+09	4.2505e+09	1.4669e+10	1.3518e+10	2.0939e+08	1.543e+08	7.4239e+08	2.9322e+09	0.038044	8.276e+09	7.3257e+10	4.9918e+10	3.135e+10	2.1461e+10	1.7416e+10	1.3963e+10	6.894e+09	3.6134e+09	4.637e+07	6.7594e+07	2.1511e+08	1.031e+09	4.0363e+07	2.2615e+11
5.9939	2.3448e+08	9.8613e+09	4.5037e+09	1.7253e+10	1.7584e+10	3.5558e+08	2.3309e+08	1.2607e+09	4.7865e+09	0.036908	8.9161e+09	6.7425e+10	4.6663e+10	2.9095e+10	2.0091e+10	1.6362e+10	1.3265e+10	6.5915e+09	3.4869e+09	4.632e+07	1.2806e+08	3.8696e+08	1.772e+09	7.4387e+07	2.1189e+11
6.508	2.3806e+08	1.2298e+10	4.7198e+09	1.9929e+10	2.2212e+10	5.8154e+08	3.4411e+08	2.0618e+09	7.5808e+09	0.035793	9.5865e+09	6.182e+10	4.3339e+10	2.6854e+10	1.8676e+10	1.5255e+10	1.2481e+10	6.2363e+09	3.3249e+09	4.6204e+07	2.308e+08	6.6412e+08	2.9265e+09	1.3072e+08	1.9757e+11
7.053	2.3827e+08	1.5062e+10	4.9006e+09	2.2654e+10	2.7322e+10	9.1984e+08	4.9791e+08	3.2612e+09	1.1682e+10	0.034702	1.0295e+10	5.6499e+10	4.0033e+10	2.4672e+10	1.7261e+10	1.4132e+10	1.1651e+10	5.8485e+09	3.1389e+09	4.602e+07	3.9793e+08	1.0935e+09	4.6655e+09	2.2021e+08	1.8353e+11
7.638	2.3545e+08	1.8147e+10	5.0481e+09	2.5382e+10	3.2812e+10	1.4122e+09	7.0783e+08	5.0067e+09	1.7557e+10	0.033637	1.1047e+10	5.1488e+10	3.6803e+10	2.2577e+10	1.5872e+10	1.3022e+10	1.0803e+10	5.4437e+09	2.9381e+09	4.5766e+07	6.5944e+08	1.7356e+09	7.2082e+09	3.5735e+08	1.6999e+11
8.2731	2.3e+08	2.1528e+10	5.1641e+09	2.8066e+10	3.8545e+10	2.1102e+09	9.9054e+08	7.4816e+09	2.5787e+10	0.0326	1.1839e+10	4.6794e+10	3.3688e+10	2.0586e+10	1.453e+10	1.194e+10	9.9567e+09	5.0338e+09	2.7299e+09	4.5437e+07	1.0545e+09	2.6659e+09	1.0826e+10	5.6074e+08	1.571e+11
8.9694	2.2232e+08	2.517e+10	5.25e+09	3.0656e+10	4.4367e+10	3.0776e+09	1.3669e+09	1.0912e+10	3.7091e+10	0.031592	1.2665e+10	4.2413e+10	3.0712e+10	1.8705e+10	1.3246e+10	1.09e+10	9.1281e+09	4.6277e+09	2.5198e+09	4.5032e+07	1.6327e+09	3.977e+09	1.5854e+10	8.54e+08	1.4492e+11
9.7387	2.1281e+08	2.9024e+10	5.3071e+09	3.3103e+10	5.0108e+10	4.3883e+09	1.8619e+09	1.5559e+10	5.2307e+10	0.030615	1.3507e+10	3.8338e+10	2.7893e+10	1.6941e+10	1.2028e+10	9.9095e+09	8.3277e+09	4.2318e+09	2.3122e+09	4.4547e+07	2.454e+09	5.7767e+09	2.268e+10	1.2655e+09	1.3349e+11
10.595	2.0185e+08	3.3033e+10	5.3366e+09	3.536e+10	5.5598e+10	6.1301e+09	2.5066e+09	2.1734e+10	7.2439e+10	0.029666	1.4343e+10	3.4553e+10	2.5237e+10	1.5291e+10	1.0881e+10	8.9726e+09	7.5621e+09	3.8504e+09	2.11e+09	4.3982e+07	3.5894e+09	8.192e+09	3.1764e+10	1.8299e+09	1.228e+11
11.555	1.8982e+08	3.7128e+10	5.3392e+09	3.7379e+10	6.0668e+10	8.4021e+09	3.3374e+09	2.9789e+10	9.8632e+10	0.028746	1.5145e+10	3.1047e+10	2.2748e+10	1.3755e+10	9.8057e+09	8.0923e+09	6.8365e+09	3.4868e+09	1.9155e+09	4.3334e+07	5.1199e+09	1.1366e+10	4.3625e+10	2.5876e+09	1.1283e+11
12.636	1.7704e+08	4.1238e+10	5.3159e+09	3.9119e+10	6.5166e+10	1.1316e+10	4.3983e+09	4.0122e+10	1.322e+11	0.027853	1.5882e+10	2.7805e+10	2.0424e+10	1.2329e+10	8.8022e+09	7.2688e+09	6.153e+09	3.1427e+09	1.7302e+09	4.2601e+07	7.1355e+09	1.546e+10	5.8852e+10	3.5856e+09	1.0354e+11
13.862	1.6382e+08	4.5284e+10	5.2674e+09	4.0541e+10	6.8961e+10	1.4999e+10	5.7405e+09	5.3177e+10	1.7462e+11	0.026985	1.6522e+10	2.4811e+10	1.8263e+10	1.1008e+10	7.8691e+09	6.502e+09	5.513e+09	2.8193e+09	1.5551e+09	4.1784e+07	9.7336e+09	2.0653e+10	7.81e+10	4.8784e+09	9.4863e+10
15.262	1.5042e+08	4.9187e+10	5.1941e+09	4.1609e+10	7.1942e+10	1.9586e+10	7.4236e+09	6.944e+10	2.2754e+11	0.026144	1.7036e+10	2.2053e+10	1.6261e+10	9.7894e+09	7.005e+09	5.7907e+09	4.9167e+09	2.5171e+09	1.3907e+09	4.0879e+07	1.3016e+10	2.7139e+10	1.0209e+11	6.5274e+09	8.676e+10
16.87	1.3707e+08	5.2872e+10	5.0966e+09	4.2292e+10	7.4032e+10	2.5225e+10	9.5145e+09	8.9434e+10	2.9275e+11	0.025332	1.7397e+10	1.9518e+10	1.4412e+10	8.6668e+09	6.2071e+09	5.1331e+09	4.3636e+09	2.236e+09	1.2371e+09	3.9885e+07	1.7087e+10	3.5129e+10	1.3158e+11	8.6008e+09	7.9171e+10
18.727	1.2396e+08	5.6261e+10	4.9751e+09	4.2566e+10	7.5176e+10	3.2065e+10	1.2085e+10	1.1368e+11	3.7206e+11	0.024552	1.7584e+10	1.7195e+10	1.2712e+10	7.6371e+09	5.4736e+09	4.5281e+09	3.8532e+09	1.9761e+09	1.0947e+09	3.8794e+07	2.2042e+10	4.4832e+10	1.6736e+11	1.117e+10	7.2053e+10
20.88	1.1128e+08	5.9282e+10	4.8303e+09	4.2415e+10	7.5357e+10	4.0233e+10	1.5202e+10	1.4264e+11	4.671e+11	0.023808	1.7582e+10	1.5075e+10	1.1156e+10	6.6965e+09	4.8025e+09	3.9741e+09	3.3847e+09	1.7371e+09	9.6344e+08	3.7602e+07	2.7957e+10	5.6427e+10	2.1009e+11	1.4302e+10	6.537e+10
23.376	9.9192e+07	6.1866e+10	4.663e+09	4.1839e+10	7.4594e+10	4.9812e+10	1.8917e+10	1.7661e+11	5.7895e+11	0.023105	1.7385e+10	1.3154e+10	9.7422e+09	5.8437e+09	4.1932e+09	3.4708e+09	2.9583e+09	1.5192e+09	8.4348e+08	3.6301e+07	3.4867e+10	7.0031e+10	2.602e+11	1.8048e+10	5.9109e+10
26.26	8.7834e+07	6.3966e+10	4.4747e+09	4.0858e+10	7.2951e+10	6.0822e+10	2.3259e+10	2.1564e+11	7.0799e+11	0.022439	1.6998e+10	1.1426e+10	8.4686e+09	5.0764e+09	3.6444e+09	3.0172e+09	2.5734e+09	1.3223e+09	7.3484e+08	3.489e+07	4.276e+10	8.567e+10	3.178e+11	2.2432e+10	5.3261e+10
29.567	7.7341e+07	6.5548e+10	4.268e+09	3.9511e+10	7.0533e+10	7.319e+10	2.8217e+10	2.5949e+11	8.5348e+11	0.021801	1.6439e+10	9.8884e+09	7.3338e+09	4.3936e+09	3.1554e+09	2.6129e+09	2.2299e+09	1.1464e+09	6.3762e+08	3.3371e+07	5.1559e+10	1.0324e+11	3.8251e+11	2.7442e+10	4.7837e+10
33.32	6.7794e+07	6.6605e+10	4.0463e+09	3.7856e+10	6.7478e+10	8.6769e+10	3.3748e+10	3.0764e+11	1.0138e+12	0.021169	1.5733e+10	8.535e+09	6.3333e+09	3.7922e+09	2.7245e+09	2.2565e+09	1.9267e+09	9.9104e+08	5.516e+08	3.1753e+07	6.114e+10	1.2253e+11	4.5355e+11	3.303e+10	4.2844e+10
37.538	5.921e+07	6.7161e+10	3.813e+09	3.5958e+10	6.3933e+10	1.0138e+11	3.9789e+10	3.5944e+11	1.1869e+12	0.020507	1.491e+10	7.3517e+09	5.4578e+09	3.2665e+09	2.3475e+09	1.9446e+09	1.6611e+09	8.5479e+08	4.7609e+08	3.005e+07	7.1364e+10	1.4328e+11	5.3001e+11	3.9133e+10	3.827e+10
42.214	5.1579e+07	6.7256e+10	3.5725e+09	3.3891e+10	6.0056e+10	1.1679e+11	4.6246e+10	4.1406e+11	1.37e+12	0.019773	1.4006e+10	6.3248e+09	4.6974e+09	2.8102e+09	2.0202e+09	1.6736e+09	1.4303e+09	7.3628e+08	4.1033e+08	2.8283e+07	8.2057e+10	1.6517e+11	6.1062e+11	4.5653e+10	3.4109e+10];

%The cutoff electric field below which rates are assumed to be zero.
efrange = [1.0000000000000000e+002  3.1622776601683791e+005  3.5481338923357532e+005  7.0794578438413801e+003  5.0118723362727248e+005  1.122e+06  1.4125375446227554e+006  1.122e+06  1.4125375446227554e+006  1.1220184543019631e+006  1.0000000000000000e+002  1.0000000000000000e+002  1.4125375446227556e+004  1.5848931924611141e+004  2.5118864315095823e+004  1.1220184543019630e+004  2.2387211385683378e+004  7.0794578438413737e+004  8.9125093813374595e+004  1.0000000000000000e+005  1.0000000000000000e+002  1.5848931924611141e+006  1.1220184543019631e+006  1.1220184543019631e+006  1.1220184543019631e+006  1.0000000000000000e+002];
%efrange = [1.0000e+02  1.5210e+05  1.122e+06  1.4125375446227554e+006  1.1220184543019631e+006  1.122e+06  1.4125375446227554e+006  1.0050e+06  1.0051e+06  1.0050e+06  1.0000e+002  1.0000e+002  1.010e+04  1.010e+04  1.010e+04  1.1220184543019630e+004  1.010e+04  1.610e+04  2.010e+04  2.610e+04  1.0000e+002  1.0000e+06  1.0000e+06  1.0000e+06  1.0000e+06  1.0000e+002];

%Calculate Rates
r(ef < efrange(i)) = ((i==1)*eng0+(i==11)*mob0+(i==12)*N2v10+(i==21)*CO2v0+(i==26)*N2sv0 ) * ( (i==11)*1/n_n0+(i==1)+(i~=1)*(i~=11)*n_n0 );
r(ef >= efrange(i) & logef <= log_emax) = 10.^(interp1q(log10(field'), log10(table(:,i)+1e-16), logef(ef >= efrange(i) & logef <= log_emax)'))*((i==11)*1/n_n0+(i==1)+(i~=1)*(i~=11)*n_n0);
r(logef > log_emax) = 10.^(interp1(log10(field), log10(table(:,i)+1e-16), logef(logef > log_emax), 'linear', 'extrap'))*((i==11)*1/n_n0+(i==1)+(i~=1)*(i~=11)*n_n0);

%if(max(logef) > log_emax)    
%    warning('ELECTRIC FIELD IS TOO LARGE (E*N_0/N>6.3e+7 V/m), RESULT MAY NOT BE VALID')
%end %if
